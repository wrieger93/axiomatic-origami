(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     23814,        646]
NotebookOptionsPosition[     23340,        625]
NotebookOutlinePosition[     23684,        640]
CellTagsIndexPosition[     23641,        637]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BeginPackage", "[", "\"\<OrigamiReference2D`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pointQ", "[", "p_", "]"}], ":=", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"p", ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_"}], "}"}], "/;", 
      RowBox[{"Element", "[", 
       RowBox[{
        RowBox[{"x", "|", "y"}], ",", "Reals"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vectorQ", "[", "v_", "]"}], ":=", 
   RowBox[{"pointQ", "[", "v", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lineQ", "[", "l_", "]"}], ":=", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"l", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"cos_", ",", "d_"}], "}"}], "/;", 
       RowBox[{
        RowBox[{"-", "1"}], "<", "cos", "\[LessEqual]", "1"}]}], "/;", 
      RowBox[{"Element", "[", 
       RowBox[{"d", ",", "Reals"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lineSegmentQ", "[", "lseg_", "]"}], ":=", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"lseg", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"l_", ",", "t1_", ",", "t2_"}], "}"}], "/;", 
        RowBox[{"lineQ", "[", "l", "]"}]}], "/;", 
       RowBox[{"Element", "[", 
        RowBox[{
         RowBox[{"t1", "|", "t2"}], ",", "Reals"}], "]"}]}], "/;", 
      RowBox[{"t1", "<", "t2"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"upar", "[", "l_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"l", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uperp", "[", "l_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"l", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"l", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vectorRotate", "[", 
     RowBox[{"v_", ",", "\[Theta]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"RotationTransform", "[", "\[Theta]", "]"}], "[", "v", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"lineParametricPoint", "[", 
     RowBox[{"l_", ",", "t_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"l", "[", 
       RowBox[{"[", "2", "]"}], "]"}], " ", 
      RowBox[{"uperp", "[", "l", "]"}]}], "+", 
     RowBox[{"t", " ", 
      RowBox[{"upar", "[", "l", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vectorNorm", "[", "v_", "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"v", ".", "v"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pointDistance", "[", 
    RowBox[{"p1_", ",", "p2_"}], "]"}], ":=", 
   RowBox[{"vectorNorm", "[", 
    RowBox[{"p1", "-", "p2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pointLineDistance", "[", 
    RowBox[{"p_", ",", "l_"}], "]"}], ":=", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"uperp", "[", "l", "]"}], ".", "p"}], "-", 
     RowBox[{"l", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pointLiesOnLine", "[", 
    RowBox[{"p_", ",", "l_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"pointLineDistance", "[", 
     RowBox[{"p", ",", "l"}], "]"}], "\[Equal]", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointLiesOnLineSegment", "[", 
     RowBox[{"p_", ",", "lseg_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"pointLiesOnLine", "[", 
      RowBox[{"p", ",", 
       RowBox[{"lseg", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&&", 
     RowBox[{
      RowBox[{"lseg", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
      RowBox[{"pointParameterOnLine", "[", 
       RowBox[{"p", ",", 
        RowBox[{"lseg", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[LessEqual]", 
      RowBox[{"lseg", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointParameterOnLine", "[", 
     RowBox[{"p_", ",", "l_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"upar", "[", "l", "]"}], ".", "p"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lineThroughPoints", "[", 
    RowBox[{"p1_", ",", "p2_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sorted", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p1", ",", "p2"}], "}"}], ",", "Last"}], "]"}]}], ",", 
       "pmax", ",", "pmin", ",", "cos", ",", "d"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pmin", "=", 
       RowBox[{"sorted", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", 
      RowBox[{"pmax", "=", 
       RowBox[{"sorted", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cos", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pmax", "-", "pmin"}], ")"}], "/", 
          RowBox[{"pointDistance", "[", 
           RowBox[{"pmax", ",", "pmin"}], "]"}]}], ")"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"pmax", ".", 
        RowBox[{"uperp", "[", 
         RowBox[{"{", 
          RowBox[{"cos", ",", "0"}], "}"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"cos", ",", "d"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lineSegmentThroughPoints", "[", 
    RowBox[{"p1_", ",", "p2_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", "=", 
       RowBox[{"lineThroughPoints", "[", 
        RowBox[{"p1", ",", "p2"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "l", "}"}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pointParameterOnLine", "[", 
            RowBox[{"#", ",", "l"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"p1", ",", "p2"}], "}"}]}], ",", "Less"}], "]"}]}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"lineSegmentEndpoints", "[", "lseg_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"lineParametricPoint", "[", 
       RowBox[{
        RowBox[{"lseg", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"Sort", "[", 
      RowBox[{"lseg", "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;", "3"}], "]"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"lineIntersection", "[", 
      RowBox[{"l1_", ",", "l2_"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"l1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", 
      RowBox[{"l2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ":=", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d1", "=", 
         RowBox[{"l1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"d2", "=", 
         RowBox[{"l2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"lineParametricPoint", "[", 
       RowBox[{"l1", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d2", "-", 
           RowBox[{"d1", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"uperp", "[", "l1", "]"}], ".", 
              RowBox[{"uperp", "[", "l2", "]"}]}], ")"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"upar", "[", "l1", "]"}], ".", 
           RowBox[{"uperp", "[", "l2", "]"}]}], ")"}]}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"projectPointOntoLine", "[", 
     RowBox[{"p_", ",", "l_"}], "]"}], ":=", 
    RowBox[{"p", "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", ".", 
         RowBox[{"uperp", "[", "l", "]"}]}], "-", 
        RowBox[{"l", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
      RowBox[{"uperp", "[", "l", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"reflectPointAcrossLine", "[", 
    RowBox[{"p_", ",", "l_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"projectPointOntoLine", "[", 
      RowBox[{"p", ",", "l"}], "]"}]}], "-", "p"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"reflectLineAcrossLine", "[", 
    RowBox[{"l1_", ",", "l2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"reflectLineSegmentAcrossLine", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l1", ",", "0", ",", "1"}], "}"}], ",", "l2"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"reflectLineSegmentAcrossLine", "[", 
     RowBox[{"lseg_", ",", "l_"}], "]"}], ":=", 
    RowBox[{"lineSegmentThroughPoints", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"reflectPointAcrossLine", "[", 
         RowBox[{"#", ",", "l"}], "]"}], "&"}], "/@", 
       RowBox[{"lineSegmentEndpoints", "[", "lseg", "]"}]}], ")"}]}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pointToLine", "[", "p_", "]"}], ":=", 
   RowBox[{"lineThroughPoints", "[", 
    RowBox[{"p", ",", 
     RowBox[{"p", "+", 
      RowBox[{"vectorRotate", "[", 
       RowBox[{"p", ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotPoint", "[", 
    RowBox[{"p_", ",", 
     RowBox[{"range_:", "1"}]}], "]"}], ":=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
       RowBox[{"Point", "[", "p", "]"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"range", "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotLine", "[", 
    RowBox[{"l_", ",", 
     RowBox[{"range_:", "1"}]}], "]"}], ":=", 
   RowBox[{"ParametricPlot", "[", 
    RowBox[{
     RowBox[{"lineParametricPoint", "[", 
      RowBox[{"l", ",", "t"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"range", "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], ",", 
     RowBox[{"PlotStyle", "->", "Thick"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotLineSegment", "[", 
    RowBox[{"lseg_", ",", 
     RowBox[{"range_:", "1"}]}], "]"}], ":=", 
   RowBox[{"ParametricPlot", "[", 
    RowBox[{
     RowBox[{"lineParametricPoint", "[", 
      RowBox[{
       RowBox[{"lseg", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "t"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{"lseg", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"lseg", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"range", "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], ",", 
     RowBox[{"PlotStyle", "->", "Thick"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"plotGraphics", "[", 
     RowBox[{"ps_", ",", "ls_", ",", "lsegs_", ",", 
      RowBox[{"range_:", "1"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"plotPoint", "[", 
          RowBox[{"#", ",", "range"}], "]"}], "&"}], "/@", "ps"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"plotLine", "[", 
          RowBox[{"#", ",", "range"}], "]"}], "&"}], "/@", "ls"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"plotLineSegment", "[", 
          RowBox[{"#", ",", "range"}], "]"}], "&"}], "/@", "lsegs"}]}], "]"}],
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6422022051161847`*^9, 3.642202207762063*^9}, {
   3.6422026992149563`*^9, 3.6422027099265623`*^9}, {3.642202771401203*^9, 
   3.64220278762372*^9}, {3.6422028454047403`*^9, 3.642202893484873*^9}, {
   3.642202999530176*^9, 3.642203004969038*^9}, {3.642203036986748*^9, 
   3.6422030985264363`*^9}, {3.6422031425316763`*^9, 
   3.6422032991318703`*^9}, {3.6422034650646567`*^9, 3.64220351257438*^9}, {
   3.6422666921532164`*^9, 3.6422667232412863`*^9}, {3.6422668058719473`*^9, 
   3.6422668060420694`*^9}, {3.6422669523319225`*^9, 3.642267026357475*^9}, {
   3.642267100794319*^9, 3.642267110196992*^9}, {3.6422672649508753`*^9, 
   3.642267271863765*^9}, 3.642267334035903*^9, {3.6422673779020443`*^9, 
   3.642267399215175*^9}, {3.642267509959813*^9, 3.642267512950918*^9}, {
   3.642268193304914*^9, 3.6422682354798574`*^9}, {3.6422684301820803`*^9, 
   3.6422684335614796`*^9}, 3.642268603356021*^9, {3.642268658047846*^9, 
   3.6422686582730074`*^9}, {3.642268715232442*^9, 3.6422687220873103`*^9}, {
   3.6422688119831295`*^9, 3.6422688989198475`*^9}, {3.642269150791401*^9, 
   3.642269167719437*^9}, {3.642269204491542*^9, 3.6422692819465294`*^9}, {
   3.642270551525832*^9, 3.6422705629269257`*^9}, {3.6422705974944487`*^9, 
   3.6422705981109037`*^9}, {3.6422707982449827`*^9, 
   3.6422708211612515`*^9}, {3.6422709456466265`*^9, 
   3.6422710089055157`*^9}, {3.642271191975484*^9, 3.6422712006426535`*^9}, {
   3.642271712824517*^9, 3.64227173076525*^9}, {3.6422717934057226`*^9, 
   3.642271826123968*^9}, {3.6422719159007025`*^9, 3.642271964303046*^9}, {
   3.6422869911331615`*^9, 3.642287061943411*^9}, {3.6422871023120723`*^9, 
   3.6422871080191236`*^9}, {3.6422871925901623`*^9, 
   3.6422871952360544`*^9}, {3.642287242398523*^9, 3.642287366419566*^9}, {
   3.6422874070344186`*^9, 3.642287485392047*^9}, {3.6422875549654264`*^9, 
   3.642287627401844*^9}, {3.6422876597177863`*^9, 3.6422876611578264`*^9}, {
   3.6422879019157457`*^9, 3.6422879052571*^9}, {3.6422880460520535`*^9, 
   3.642288112145973*^9}, {3.6422881430489273`*^9, 3.6422882607074585`*^9}, {
   3.6422882913852396`*^9, 3.642288345573708*^9}, {3.6422884315447226`*^9, 
   3.642288438043337*^9}, {3.6422887294756036`*^9, 3.642288732771943*^9}, 
   3.642288872172908*^9, {3.642288916435348*^9, 3.6422890499010944`*^9}, {
   3.642289316541374*^9, 3.642289325522768*^9}, {3.642289911069805*^9, 
   3.6422899637962365`*^9}, {3.642290132953307*^9, 3.6422901531576495`*^9}, {
   3.6422908323788624`*^9, 3.642290891071515*^9}, {3.642290957243487*^9, 
   3.642290960252627*^9}, {3.6422910630900064`*^9, 3.6422911129413967`*^9}, {
   3.642291161442855*^9, 3.642291181880364*^9}, {3.6422912475759754`*^9, 
   3.642291254193672*^9}, {3.6422917365411205`*^9, 3.6422918553474455`*^9}, 
   3.6422919627540812`*^9, {3.6422920126775227`*^9, 3.642292179453929*^9}, {
   3.642292228020418*^9, 3.6422922311095943`*^9}, {3.6422922645403256`*^9, 
   3.642292274852648*^9}, {3.642292315376416*^9, 3.6422923168594704`*^9}, {
   3.6422924157767124`*^9, 3.6422924304090943`*^9}, {3.6422928855482073`*^9, 
   3.642292891155173*^9}, {3.6422929833476257`*^9, 3.642293025643654*^9}, {
   3.642293062699957*^9, 3.6422931163360357`*^9}, {3.642293381966919*^9, 
   3.6422933866522408`*^9}, {3.6422937802756853`*^9, 
   3.6422937825923457`*^9}, {3.6422941927609863`*^9, 
   3.6422942237891116`*^9}, {3.642294298878415*^9, 3.6422943037668858`*^9}, {
   3.642294869343401*^9, 3.6422948858220997`*^9}, {3.642294955399499*^9, 
   3.6422950017934303`*^9}, {3.642295147918168*^9, 3.6422952526935673`*^9}, {
   3.6422952963145156`*^9, 3.642295422027782*^9}, {3.6422957232446833`*^9, 
   3.6422957337421455`*^9}, {3.642374192740221*^9, 3.6423743143145123`*^9}, {
   3.6423744120274*^9, 3.6423744374334383`*^9}, {3.6423745169538927`*^9, 
   3.642374536390703*^9}, {3.6423752341821747`*^9, 3.642375272701502*^9}, {
   3.6423753727832837`*^9, 3.6423754440989127`*^9}, 3.642375674365383*^9, {
   3.6423759431542063`*^9, 3.642375946829811*^9}, {3.6423760439297447`*^9, 
   3.642376061603312*^9}, {3.6423761041585054`*^9, 3.642376104923046*^9}, {
   3.6423761621266594`*^9, 3.642376169444852*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"l1", "=", 
        RowBox[{"pointToLine", "[", "p1", "]"}]}], ",", 
       RowBox[{"l2", "=", 
        RowBox[{"pointToLine", "[", "p2", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"plotGraphics", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l1", ",", "l2", ",", 
         RowBox[{"reflectLineAcrossLine", "[", 
          RowBox[{"l1", ",", "l2"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", "}"}], ",", "5"}], "]"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", "Locator"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p2", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", "Locator"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6423754488723*^9, 3.642375515536628*^9}, 
   3.6423755529111595`*^9, {3.6423756908380775`*^9, 3.642375695639486*^9}, 
   3.642375742781953*^9, {3.642375797772992*^9, 3.642375815418536*^9}, {
   3.6423758637458477`*^9, 3.6423758684992185`*^9}, {3.6423759679167976`*^9, 
   3.642376001373535*^9}, {3.6423760789696207`*^9, 3.642376087690813*^9}, 
   3.6423761800073533`*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{
    OrigamiReference2D`p1$$ = {-0.3200000000000003, -0.2400000000000002}, 
    OrigamiReference2D`p2$$ = {2.0700000000000003`, 0.17999999999999972`}, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[OrigamiReference2D`p1$$], {1, 0}}, Automatic}, {{
       Hold[OrigamiReference2D`p2$$], {0, 1}}, Automatic}}, Typeset`size$$ = {
    360., {178., 182.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {
       OrigamiReference2D`p1$$ = {1, 0}, OrigamiReference2D`p2$$ = {0, 1}}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      With[{OrigamiReference2D`l1 = 
         OrigamiReference2D`pointToLine[OrigamiReference2D`p1$$], 
         OrigamiReference2D`l2 = 
         OrigamiReference2D`pointToLine[OrigamiReference2D`p2$$]}, 
        OrigamiReference2D`plotGraphics[{}, {
         OrigamiReference2D`l1, OrigamiReference2D`l2, 
          OrigamiReference2D`reflectLineAcrossLine[
          OrigamiReference2D`l1, OrigamiReference2D`l2]}, {}, 5]], 
      "Specifications" :> {{{OrigamiReference2D`p1$$, {1, 0}}, Automatic, 
         ControlType -> Locator}, {{OrigamiReference2D`p2$$, {0, 1}}, 
         Automatic, ControlType -> Locator}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{417., {211., 218.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.6423755165223293`*^9, 3.6423755538958592`*^9, 3.642375597610893*^9, {
   3.642375677905917*^9, 3.642375696159855*^9}, 3.6423757437876883`*^9, {
   3.6423758109343567`*^9, 3.6423758162881575`*^9}, 3.6423758699682665`*^9, {
   3.642375949118457*^9, 3.642375972062727*^9}, 3.642376002301195*^9, {
   3.6423760882211885`*^9, 3.6423761071156025`*^9}, {3.6423761715413446`*^9, 
   3.6423761805867805`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reflectLineAcrossLine", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "0"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.642375525581778*^9, 3.6423755391714087`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.6423755396227455`*^9}]
}, Open  ]]
},
WindowSize->{1600, 827},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 18140, 486, 1092, "Input"],
Cell[CellGroupData[{
Cell[18723, 510, 1454, 39, 92, "Input"],
Cell[20180, 551, 2663, 52, 446, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22880, 608, 324, 9, 31, "Input"],
Cell[23207, 619, 117, 3, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
